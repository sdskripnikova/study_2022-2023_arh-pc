define("feast-tpl!app/feast-tpl!ui-block/layer-shortcut/layer-shortcut.html",["feast"],function(a){return a.smartParse('<div>\n\t<b:layer name="shortcut"\n\t\t\t\t remit:close="layer:close"\n\t\t\t\t close\n\t\t\t\t center\n\t\t\t\t header\n\t\t\t\t standard>\n\n\t\t\t<fn:match name="header">\n\t\t\t\t{i18n(\'Горячие клавиши\')}\n\t\t\t</fn:match>\n\n\t\t\t<fn:match name="content">\n\n\t\t\t\t<fn:match name="layer-col" args="col, i">\n\n\t\t\t\t\t<fn:match name="layer-col-group" args="group, i">\n\n\t\t\t\t\t\t<fn:match name="layer-col-group-item" args="item, i">\n\t\t\t\t\t\t\t<div bem:elem="item" key="{i}" data-item-name="{item.name}">\n\t\t\t\t\t\t\t\t<span bem:elem="item__shortcut">\n\t\t\t\t\t\t\t\t\t<fn:if test="item.shortcutMods">\n\t\t\t\t\t\t\t\t\t\t<fn:for data="item.shortcutMods" key="i" as="mod">\n\t\t\t\t\t\t\t\t\t\t\t<fn:if test="i">+</fn:if>\n\t\t\t\t\t\t\t\t\t\t\t<fn:value>mod</fn:value>\n\t\t\t\t\t\t\t\t\t\t</fn:for>\n\t\t\t\t\t\t\t\t\t</fn:if>\n\t\t\t\t\t\t\t\t\t<fn:if test="item.shortcut">\n\t\t\t\t\t\t\t\t\t\t<fn:if test="item.shortcutMods">+</fn:if>\n\t\t\t\t\t\t\t\t\t\t<fn:value>item.shortcut</fn:value>\n\t\t\t\t\t\t\t\t\t</fn:if>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span bem:elem="item__text">\n\t\t\t\t\t\t\t\t\t<fn:value output="raw">item.name</fn:value>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</fn:match>\n\n\t\t\t\t\t\t<div bem:elem="item" key="{i}">\n\t\t\t\t\t\t\t<bem:mod name="header" />\n\t\t\t\t\t\t\t<bem:mod name="header_gap" test="i" />\n\t\t\t\t\t\t\t<fn:value>group.group</fn:value>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<fn:var name="groupIdx" value="{i}"/>\n\n\t\t\t\t\t\t<fn:for data="group.items" key="i" as="item">\n\t\t\t\t\t\t\t<fn:var name="i" value="{groupIdx + \'_\' + i}"/>\n\t\t\t\t\t\t\t<fn:apply-match name="layer-col-group-item" args="item, i" />\n\t\t\t\t\t\t</fn:for>\n\t\t\t\t\t</fn:match>\n\n\t\t\t\t\t<div bem:elem="column" key="{i}">\n\t\t\t\t\t\t<fn:for data="col" key="i" as="group">\n\t\t\t\t\t\t\t<fn:apply-match name="layer-col-group" args="group, i" />\n\t\t\t\t\t\t</fn:for>\n\t\t\t\t\t</div>\n\t\t\t\t</fn:match>\n\n\t\t\t\t<div bem:elem="row">\n\t\t\t\t\t<fn:for data="_this.cols" key="i" as="col">\n\t\t\t\t\t\t<fn:apply-match name="layer-col" args="col, i" />\n\t\t\t\t\t</fn:for>\n\t\t\t\t</div>\n\n\t\t\t</fn:match>\n\n\t\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-shortcut/layer-shortcut.html")});define("feast-tpl!ui-block/layer-shortcut/layer-shortcut.html",["feast-tpl!app/feast-tpl!ui-block/layer-shortcut/layer-shortcut.html"],function(a){return a});var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;Object.defineProperty(a,d,{enumerable:true,get:function(){return b[c]}})}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-shortcut/layer-shortcut",["require","exports","default-values","feast","feast-tpl!./layer-shortcut.html","helpers/browser","ui-block/layer/layer"],function(require,exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importStar(b);c=__importStar(c);d=__importDefault(d);e=__importDefault(e);var f=d.default.mac?"Cmd":"Ctrl";exports.default=b.Block.extend({name:"layer-shortcut",template:c,cols:[[{group:i18n("Общие"),items:[{name:i18n("Вызов справки по хоткеям"),shortcutMods:["Shift"],shortcut:"?"},{name:i18n("Написать письмо"),shortcut:"N"},{name:i18n("Поиск"),shortcut:"/"},{name:i18n("Перейти в адресную книгу"),shortcut:"G "+i18n("затем")+" C"}]},{group:i18n("Написание письма"),items:[{name:i18n("Отправить письмо"),shortcutMods:[f,"Enter"]},{name:i18n("Сохранить черновик"),shortcutMods:[f],shortcut:"S"}]},{group:i18n("Отправка письма"),items:[{name:i18n("Отменить отправку"),shortcutMods:[f],shortcut:"Z"}]}],[{group:i18n("Список писем"),items:[{name:i18n("Выделить все письма/снять выделение"),shortcutMods:[f],shortcut:"A"},{name:i18n("Удалить"),shortcutMods:[d.default.mac?"Cmd+Backspace":"Del"]},{name:i18n("В архив"),shortcut:"E"},!a.FORBID_SPAM&&{name:i18n("Это спам/Не спам"),shortcutMods:["Shift"],shortcut:"J"},{name:i18n("Переместить в папку"),shortcut:"V"},{name:i18n("Еще действия"),shortcut:"."},{name:i18n("Пометить прочитанными"),shortcut:"Q"},{name:i18n("Пометить непрочитанными"),shortcut:"U"},{name:i18n("Пометить флажком/Снять флажок"),shortcut:"I"},{name:i18n("Перейти во Входящие"),shortcut:"G "+i18n("затем")+" I"},{name:i18n("Перейти в Черновики"),shortcut:"G "+i18n("затем")+" D"},{name:i18n("Перейти в Отправленные"),shortcut:"G "+i18n("затем")+" S"},{name:i18n("Перейти в «Помеченные флажком»"),shortcut:"G "+i18n("затем")+" L"}]}],[{group:i18n("Чтение письма"),items:[{name:i18n("Выход из письма"),shortcutMods:["Esc"]},{name:i18n("Предыдущее/следующее письмо"),shortcutMods:["Ctrl"],shortcut:d.default.mac?"J/K":"↑/↓"},{name:i18n("Ответить"),shortcut:"R"},{name:i18n("Ответить всем"),shortcutMods:["Shift"],shortcut:"R"},{name:i18n("Переслать"),shortcut:"F"},{name:i18n("Удалить письмо"),shortcutMods:[d.default.mac?"Cmd+Backspace":"Del"]},{name:i18n("В архив"),shortcut:"E"},!a.FORBID_SPAM&&{name:i18n("Это спам/Не спам"),shortcutMods:["Shift"],shortcut:"J"},{name:i18n("Переместить в папку"),shortcut:"V"},{name:i18n("Еще действия"),shortcut:"."},{name:i18n("Пометить прочитанным"),shortcut:"Q"},{name:i18n("Пометить непрочитанным"),shortcut:"U"},{name:i18n("Пометить флажком/Снять флажок"),shortcut:"I"},{name:i18n("Найти все письма отправителя"),shortcutMods:["Shift"],shortcut:"S"},{name:i18n("Распечатать"),shortcutMods:[d.default.mac?"Cmd":"Ctrl"],shortcut:"P"}]}]],blocks:{layer:e.default}})});define("feast-tpl!app/feast-tpl!ui-block/layer-secure-folder/layer-secure-folder.html",["feast"],function(a){return a.smartParse("<div/>","app/feast-tpl!ui-block/layer-secure-folder/layer-secure-folder.html")});define("feast-tpl!ui-block/layer-secure-folder/layer-secure-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-secure-folder/layer-secure-folder.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-secure-folder/layer-secure-folder",["require","exports","feast","feast-tpl!./layer-secure-folder.html","service/getModule"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);exports.default=a.default.Block.extend({name:"layer-secure-folder",template:b.default,didMount:function(){var a=this;Promise.all([c.default("blitz")]).then(function(b){var c=b[0],d=c.FolderPasswordView,e=c.LayerManager;if(!a.isMounted()){return}var f=a.get("model");var g=a.layerManager||new e;g.setup(a.el,{popup:true,radarPrefix:"secure-folder"});var h=new d(g);h.handle(f).then(function(){a.broadcast("success");a.broadcast("layer:close")}).catch(function(){a.broadcast("cancel");a.broadcast("layer:close")});a.layerManager=g})}})});define("feast-tpl!app/feast-tpl!ui-block/layer-letter-redirect/layer-letter-redirect.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-letter-redirect">\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<b:layer remit:close="layer:close"\n\t\t\t model="{attrs.model}"\n\t\t\t error="{attrs.error}"\n\t\t\t errorId="{attrs.errorId}"\n\t\t\t processing="{attrs.processing}"\n\t\t\t mobile="{attrs.mobile}"\n\t\t\t name="letter-redirect"\n\t\t\t close\n\t\t\t header\n\t\t\t footer\n\t\t\t center\n\t\t\t standard>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{i18n(\'Перенаправить письмо\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<form action="" remit:submit.prevent="submit:click" remit:keydown.enter.prevent="send">\n\t\t\t\t<b:react-async\n\t\t\t\t\t\tcomponent="SuggestsForm"\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\terror="{attrs.error}"\n\t\t\t\t\t\terrorId="{attrs.errorId}"\n\t\t\t\t\t\tid="redirect"\n\t\t\t\t\t\tonChange="{_this.onChange.bind(_this)}"\n\t\t\t\t\t\tuse:mediator="themes-manager"\n\t\t\t\t/>\n\t\t\t</form>\n\t\t\t<div bem:elem="info">\n\t\t\t\t{i18n(\'Перенаправление письма позволит отправить это письмо другому получателю «как есть».\')}<br/><br/>\n\t\t\t\t{i18n(\'Чтобы отправить исходное письмо, добавив свои комментарии и сохранив вложения, воспользуйтесь функцией пересылки. Можно указывать несколько адресов, разделяя их запятыми.\')}\n\t\t\t</div>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2 remit:click="submit:click"\n\t\t\t\t\t\t   text="{i18n(\'Перенаправить\')}"\n\t\t\t\t\t\t   primary\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   qa:id="submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2 remit:click="layer:close"\n\t\t\t\t\t\t   text="{i18n(\'Отменить\')}"\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   qa:id="cancel"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-letter-redirect/layer-letter-redirect.html")});define("feast-tpl!ui-block/layer-letter-redirect/layer-letter-redirect.html",["feast-tpl!app/feast-tpl!ui-block/layer-letter-redirect/layer-letter-redirect.html"],function(a){return a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("mail/actions/Redirect",["require","exports","Action","mail/Message","RPC"],function(require,exports,a,b,c){"use strict";a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);function d(a){var b=a;return!!a&&typeof b==="object"&&b.to!==undefined&&Array.isArray(b.to)&&b.to.every(function(a){return typeof a==="string"})&&b.folderId!==undefined&&typeof b.folderId==="number"&&b.id!==undefined&&typeof b.id==="string"&&(b.captcha===undefined||typeof b.captcha==="string")}var e={bodyObjectErrors:{to:{too_many_recipients:"too_many_recipients",invalid_addresses:"invalid_addresses"},capcha:{invalid:"captcha_invalid"}},bodyStringErrors:{mrim_disabled:"mrim_disabled",internal_error:"internal_error",possible_bad_guy:"possible_bad_guy",cant_get_msg:"cant_get_msg"},customErrors:{no_correspondents:"no_correspondents",invalid_params:"invalid_params",unknown_error:"unknown_error"}};var f=a.default.extend({className:"mail.Redirect",_hasError:function(a){return"error"in a},prepare:function(a){if(!d(a)){return{error:true,message:e.customErrors.invalid_params}}if(a.to.length===0){return{error:true,message:e.customErrors.no_correspondents}}return{id:a.id,folder_id:a.folderId,to:a.to.join(", "),capcha:a.captcha}},operation:function(a){var d=this;if(this._hasError(a)){return Promise.reject(a)}return c.default.post(b.default.url("redirect"),a,{}).catch(function(a){var b=JSON.parse(a.responseText);throw __assign(__assign({},b),d._postProcessError(a))})},_postProcessError:function(a){var b=e.customErrors.unknown_error;if(a.body&&typeof a.body==="object"){Object.keys(a.body).forEach(function(c){var d=a.body[c].error;if(c in e.bodyObjectErrors&&d in e.bodyObjectErrors[c]){b=e.bodyObjectErrors[c][d]}})}if(typeof a.body==="string"&&a.body in e.bodyStringErrors){b=a.body}return{error:true,message:b}}});a.default.register("mail.Redirect",f);f.version="0.1.0";exports.default=f;return f});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-letter-redirect/layer-letter-redirect",["require","exports","@mail/contact-validation","@mail/xray","default-values","feast","feast-tpl!./layer-letter-redirect.html","mail/actions/Redirect","service/captcha","ui-block/button2/button2","ui-block/layer/layer","ui-block/react-async/react-async"],function(require,exports,a,b,c,d,e,f,g,h,i,j){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.errorMessages=void 0;b=__importDefault(b);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);h=__importDefault(h);i=__importDefault(i);j=__importDefault(j);exports.errorMessages={too_many_recipients:i18n("Слишком много адресатов"),invalid_addresses:i18n("Присутствуют некорректные адреса"),invalid_addresses_detailed:i18n("В письме присутствуют несуществующие или заблокированные адреса"),no_correspondents:i18n("Укажите адрес получателя"),mrim_disabled:i18n("Для нормальной работы необходимо сменить пароль"),internal_error:i18n("Произошла внутренняя ошибка"),possible_bad_guy:i18n("Введите код на картинке"),invalid_params:i18n("Произошла внутренняя ошибка"),captcha_invalid:i18n("Введен неверный код с картинки"),unknown_error:i18n("Произошла внутренняя ошибка")};exports.default=d.default.Block.extend({name:"layer-letter-redirect",template:e.default,blocks:{layer:i.default,button2:h.default,"react-async":j.default},events:{"submit:click":"onSubmitClick"},defaults:{error:"",errorId:null,processing:false,responsive:true,finished:false},validateCorrespondentsCount:function(a){if(a===void 0){a=false}var b="";var d=null;var e=this.ids.redirect.getComponent();var f=e.suggests.state.selected.length;var g=this.get("errorId");var h=e.suggests.state.selected.some(function(a){return a.invalid});if(a&&g!=="invalid_addresses_detailed"&&h){d="invalid_addresses";b=exports.errorMessages[d]}if(f>c.CORRESPONDENTS_LIMIT){d="too_many_recipients";b=exports.errorMessages[d]}this.set({error:b,errorId:d})},onChange:function(){this.validateCorrespondentsCount()},onSubmitClick:function(){b.default.send("l_redirect_submit");if(this.is("processing")){b.default.send("l_redirect_processing");return}this.set("processing",true);var a=this.ids.redirect.getComponent();this.validateCorrespondentsCount(true);if(this.is("errorId")){b.default.send("l_redirect_"+this.get("errorId"));this.set("processing",false);return}a.selectCorrespondentsFromString();var c=a.getAddresses();this.submitForm(c).then(this.onFormSuccess.bind(this),this.onFormError.bind(this))},onFormSuccess:function(){this.set("finished",true);this.broadcast("success");b.default.send("l_redirect_success")},onFormError:function(c){var d=this;if(c.body==="captcha-closed"){this.set({processing:false});b.default.send("l_redirect_captcha-closed");return}var e="unknown_error";var f=exports.errorMessages.unknown_error;var g=c.message;if(g&&g in exports.errorMessages){f=exports.errorMessages[g];e=g}if(g==="invalid_addresses"){f=exports.errorMessages["invalid_addresses_detailed"];e="invalid_addresses_detailed";a.getCorrespondentsFromString(c.body.to.value).forEach(function(a){d.ids.redirect.getComponent().changeValidity(a.email,false)})}this.set({processing:false,error:f,errorId:e});b.default.send("l_redirect_"+e)},onBeforeHide:function(){this.set("processing",true);if(!this.is("finished")){this.invert("finished");this.broadcast("cancel")}},submitForm:function(a){var b=this.get("model");return g.default.retryUntilCaptchaSuccess(function(c){var d=c.capcha;return f.default.execute({id:b.get("expand")||b.get("id"),folderId:parseInt(b.get("folder"),10),to:a,captcha:d}).catch(function(a){throw __assign(__assign({},a),a.error)})})}})});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-folder-clear/layer-confirm-folder-clear.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-folder-clear">\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<b:layer remit:close="layer:close"\n\t\t\t models="{attrs.models}"\n\t\t\t error="{attrs.error}"\n\t\t\t processing="{attrs.processing}"\n\t\t\t mobile="{attrs.mobile}"\n\t\t\t name="confirm-folder-clear"\n\t\t\t close\n\t\t\t header\n\t\t\t footer\n\t\t\t center\n\t\t\t standard>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{i18n(\'Очистить папку\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t{_this.getText()}\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2 remit:click="submit:click"\n\t\t\t\t\t\t   text="{i18n(\'Очистить\')}"\n\t\t\t\t\t\t   primary\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   qa:id="submit"/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2 remit:click="layer:close"\n\t\t\t\t\t\t   text="{i18n(\'Отменить\')}"\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-folder-clear/layer-confirm-folder-clear.html")});define("feast-tpl!ui-block/layer-confirm-folder-clear/layer-confirm-folder-clear.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-folder-clear/layer-confirm-folder-clear.html"],function(a){return a});define("ui-block/layer-confirm-folder-clear/layer-confirm-folder-clear",["exports","feast","feast-tpl!./layer-confirm-folder-clear.html","ui-block/button2/button2","ui-block/layer/layer"],function(exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=i(a);var f=i(b);var g=i(c);var h=i(d);function i(a){return a&&a.__esModule?a:{default:a}}exports.default=e.default.Block.extend({name:"layer-confirm-folder-clear",template:f.default,blocks:{layer:h.default,button2:g.default},events:{"submit:click":"onSubmitClick"},defaults:{},getText:function a(){var b=i18n("папки");var c=this.get("models");if(c.length>1){b=i18n("папок")}var d=c.map(function(a){return"«"+a.get("name")+"»"});return i18n("Вы действительно хотите удалить все письма из")+(" "+b+" "+d.join(", ")+"?")},onSubmitClick:function a(){this.broadcast("success")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-folder-readed/layer-confirm-folder-readed.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-folder-readed">\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<b:layer remit:close="close:click"\n\t\t\t models="{attrs.models}"\n\t\t\t error="{attrs.error}"\n\t\t\t processing="{attrs.processing}"\n\t\t\t mobile="{attrs.mobile}"\n\t\t\t name="confirm-folder-readed"\n\t\t\t close\n\t\t\t header\n\t\t\t footer\n\t\t\t center\n\t\t\t standard>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{i18n(\'Все письма в папке будут прочитаны\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t{_this.getText()}\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2 remit:click="submit:click"\n\t\t\t\t\t\t   text="{i18n(\'Прочитать\')}"\n\t\t\t\t\t\t   primary\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   qa:id="submit"\n\t\t\t\t\t\t   radar-id="submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2 remit:click="close:click"\n\t\t\t\t\t\t   text="{i18n(\'Отменить\')}"\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   radar-id="cancel"\n\t\t\t\t\t\t   qa:id="cancel"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-folder-readed/layer-confirm-folder-readed.html")});define("feast-tpl!ui-block/layer-confirm-folder-readed/layer-confirm-folder-readed.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-folder-readed/layer-confirm-folder-readed.html"],function(a){return a});define("ui-block/layer-confirm-folder-readed/layer-confirm-folder-readed",["exports","feast","feast-tpl!./layer-confirm-folder-readed.html","service/radars/decorator","ui-block/button2/button2","ui-block/layer/layer"],function(exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var f=k(a);var g=k(b);var h=k(c);var i=k(d);var j=k(e);function k(a){return a&&a.__esModule?a:{default:a}}exports.default=f.default.Block.extend((0,h.default)({})({name:"layer-confirm-folder-readed",template:g.default,blocks:{layer:j.default,button2:i.default},events:{"submit:click":"onSubmit","close:click":"onClose"},defaults:{},getText:function a(){var b=this.get("models");var c=b.map(function(a){return"«"+a.get("name")+"»"}).join(", ");return i18n.plural(b.length,[i18n("Вы действительно хотите отметить все письма в папках {folders} прочитанными?",{folders:c}),i18n("Вы действительно хотите отметить все письма в папке {folders} прочитанными?",{folders:c}),i18n("Вы действительно хотите отметить все письма в папках {folders} прочитанными?",{folders:c})])},onSubmit:function a(){this.resolveLayer({resolveType:"ok"})},onClose:function a(){this.resolveLayer({resolveType:"close"})},resolveLayer:function a(b){this.broadcast("layer:resolve",{resolveData:b,close:true})}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-move-to-spam/layer-confirm-move-to-spam.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-move-to-spam">\n\t<b:react-async\n\t\t\tuse:mediator="themes-manager"\n\t\t\tcomponent="LayerConfirmMoveToSpam"\n\t\t\tmodels="{attrs.models}"\n\t\t\ttype="{attrs.type}"\n\t\t\tactionType="{attrs.actionType}"\n\t\t\tunsubscribeModels="{attrs.unsubscribeModels}"\n\t\t\tonEvent="{_this.handleEvent}"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-move-to-spam/layer-confirm-move-to-spam.html")});define("feast-tpl!ui-block/layer-confirm-move-to-spam/layer-confirm-move-to-spam.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-move-to-spam/layer-confirm-move-to-spam.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-confirm-move-to-spam/layer-confirm-move-to-spam",["require","exports","data-source/index","feast","feast-tpl!./layer-confirm-move-to-spam.html","service/radars/decorator","ui-block/react-async/react-async"],function(require,exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);exports.default=b.default.Block.extend(d.default()({name:"layer-confirm-move-to-spam",template:c.default,defaults:{type:"confirm",actionType:"spam",models:[],unsubscribeModels:[]},events:{undo:"onUndo"},blocks:{"react-async":e.default},constructor:function(){b.default.Block.apply(this,arguments);this.handleEvent=this.handleEvent.bind(this)},handleEvent:function(a){this.broadcast(a.type,a.details)},onUndo:function(){a.default.updateAll()}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-set-theme/layer-confirm-set-theme.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-set-theme">\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<fn:match name="content" args="attrs">\n\t\t<div bem:elem="preview">\n\t\t\t<img alt="{messages.preview}" src="{attrs.model.preview}"/>\n\t\t\t<div>\n\t\t\t\t<fn:value output="raw">messages.preview</fn:value>\n\t\t\t</div>\n\t\t</div>\n\t</fn:match>\n\n\t<b:layer\n\t\tremit:close="layer:close"\n\t\tmodel="{attrs.model}"\n\t\terror="{attrs.error}"\n\t\tmobile="{attrs.mobile}"\n\t\tname="confirm-set-theme"\n\t\tclose\n\t\theader\n\t\tfooter\n\t\tcenter\n\t\tstandard\n\t\tresolvable\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{messages.header}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<fn:apply-match name="content"/>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2\n\t\t\t\t\tremit:click="layer:resolve"\n\t\t\t\t\tevent:details="{close: true}"\n\t\t\t\t\tradar-id="submit"\n\t\t\t\t\ttext="{messages.submit}"\n\t\t\t\t\tprimary\n\t\t\t\t\tcompact\n\t\t\t\t\tfluid\n\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\tqa:id="submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2\n\t\t\t\t\tremit:click="layer:close"\n\t\t\t\t\tradar-id="submit"\n\t\t\t\t\ttext="{messages.cancel}"\n\t\t\t\t\tcompact\n\t\t\t\t\tfluid\n\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\tqa:id="cancel"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-set-theme/layer-confirm-set-theme.html")});define("feast-tpl!ui-block/layer-confirm-set-theme/layer-confirm-set-theme.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-set-theme/layer-confirm-set-theme.html"],function(a){return a});define("ui-block/layer-confirm-set-theme/layer-confirm-set-theme",["exports","feast","feast-tpl!./layer-confirm-set-theme.html","ui-block/button2/button2","ui-block/layer/layer"],function(exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=i(a);var f=i(b);var g=i(c);var h=i(d);function i(a){return a&&a.__esModule?a:{default:a}}exports.default=e.default.Block.extend({name:"layer-confirm-set-theme",template:f.default,blocks:{layer:h.default,button2:g.default},getMessages:function a(){var b=this.attrs.model.title;return{header:i18n("Изменение темы оформления"),previewAlt:i18n("Превью темы оформления «{title}»",{title:b}),preview:i18n("Вы действительно хотите установить тему{nbsp}{bOpen}«{title}»{bClose}?",{"unsafe-bOpen":"<b>","unsafe-bClose":"</b>","unsafe-nbsp":"&nbsp;",title:b}),submit:i18n("Установить тему"),cancel:i18n("Отменить")}}})});define("feast-tpl!app/feast-tpl!ui-block/layer-iframe/layer-iframe.html",["feast"],function(a){return a.smartParse('<div qa:id="{attrs.testId || \'layer-iframe\'}">\n\t<fn:var name="hasCustomWidth" value="{!isNaN(+attrs.width)}" />\n\n\t<fn:attr name="style" value="width: {attrs.width}px" test="hasCustomWidth"/>\n\t<bem:mod name="size" value="{attrs.width}" test="!hasCustomWidth"/>\n\n\t<fn:var name="iframeAttrs" value="{attrs[\'iframe-attrs\']}" />\n\n\t<b:layer\n\t\tremit:close="layer:close"\n\t\tname="iframe"\n\t\tsize="{attrs.size}"\n\t\thiddenfooter\n\t\tcenter\n\t\tclose="{attrs.close}"\n\t\twidth="{attrs.width}"\n\t>\n\t\t<fn:match name="content">\n\t\t\t<iframe\n\t\t\t\tsrc="{attrs.url}"\n\t\t\t\twidth="100%"\n\t\t\t\theight="{attrs[\'height\']}"\n\t\t\t\tref="iframe"\n\t\t\t\tscrolling="{attrs.scrolling}"\n\t\t\t\tframeborder="0"\n\t\t\t>\n\t\t\t\t<fn:for data="Object.keys(iframeAttrs)" as="attrName">\n\t\t\t\t\t<fn:attr name="{attrName}" value="{iframeAttrs[attrName]}" />\n\t\t\t\t</fn:for>\n\t\t\t</iframe>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-iframe/layer-iframe.html")});define("feast-tpl!ui-block/layer-iframe/layer-iframe.html",["feast-tpl!app/feast-tpl!ui-block/layer-iframe/layer-iframe.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-iframe/layer-iframe",["require","exports","feast","feast-tpl!./layer-iframe.html","features","service/radars/index","ui-block/layer/layer","utils/util"],function(require,exports,a,b,c,d,e,f){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);exports.default=a.default.Block.extend({name:"layer-iframe",template:b.default,blocks:{layer:e.default},defaults:{width:"s",height:500,scrolling:"no"},constructor:function(){a.default.Block.apply(this,arguments);this.handlePostMessage=this.handlePostMessage.bind(this)},handlePostMessage:function(a){var b;try{b=JSON.parse(a.data)}catch(a){d.default({type:"invalid_post_message"});return}switch(b.type){case"SET_HEIGHT":{if(!f.isPositiveNumber(b.height)){return}this.refs.iframe.setAttribute("height",b.height);break}case"SET_SIZE":{var e=b.width,g=b.height;if(f.isPositiveNumber(g)){this.set("height",g)}if(f.isPositiveNumber(e)){this.set("width",e)}break}case"GO_TO":{var h=a.origin;var i=!!c.default.URL({local:true,mail:true})(h);if(!i){return}var j=this.get("router");var k=b.octaviusRouteId;if(j&&k){j.go(k);this.broadcast("layer:close")}return}case"CLOSE":{this.broadcast("layer:close");return}}this.broadcast("layer-iframe:post-message",{message:b,layer:this})},didMount:function(){window.addEventListener("message",this.handlePostMessage)},didUnmount:function(){window.removeEventListener("message",this.handlePostMessage)}})});define("feast-tpl!app/feast-tpl!ui-block/layer-moneta/layer-moneta.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-moneta">\n\t<iframe\n\t\tbem:elem="iframe"\n\t\tsrc="{attrs.url}"\n\t\tsandbox="{attrs.sandBox}"\n\t\twidth="{attrs.width}"\n\t\theight="{attrs.height}"\n\t\tscrolling="no"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-moneta/layer-moneta.html")});define("feast-tpl!ui-block/layer-moneta/layer-moneta.html",["feast-tpl!app/feast-tpl!ui-block/layer-moneta/layer-moneta.html"],function(a){return a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-moneta/layer-moneta",["require","exports","default-values","feast","feast-tpl!./layer-moneta.html","service/radars/index"],function(require,exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);var e="payment-center";exports.default=b.default.Block.extend({name:"layer-moneta",template:c.default,defaults:{height:684,width:680,url:a.MONETA_BASE_URL,sandBox:a.MONETA_SANDBOX,dwhMetrics:{}},constructor:function(){b.default.Block.apply(this,arguments);this.handlePostMessage=this.handlePostMessage.bind(this)},handlePostMessage:function(b){if(a.MONETA_POST_MESSAGE_URL_REG_EXP.test(b.origin)){try{var c=JSON.parse(b.data);switch(c.m_type){case"iframeSize":if(this.attrs.height!==c.height){this.set("height",c.height)}if(this.attrs.width!==c.width){this.set("width",c.width)}d.default({type:e+"_resize"});break;case"iframeClose":this.broadcast("layer:close");d.default({type:e+"_close"});break;case"analytics":var f={type:e+"_"+c.event,dwh:__assign(__assign({},c.data),this.get("dwhMetrics"))};if(a.PAYMENT_CENTER_KAKTAM){f.rlog=e;f.rlog_message=e+"_"+JSON.stringify(c.data)}d.default(f);break}}catch(a){d.default({type:e+"_error-parse-pm",rlog:e,rlog_message:JSON.stringify(a)})}}},didMount:function(){window.addEventListener("message",this.handlePostMessage);d.default({type:e+"_open_"+this.attrs.from+"_"+this.attrs.scenario})},didUnmount:function(){window.removeEventListener("message",this.handlePostMessage)}})});define("feast-tpl!app/feast-tpl!ui-block/layer-captcha/layer-captcha.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-captcha">\n\t<fn:match name="captcha">\n\t\t<div bem:elem="captcha-container">\n\t\t\t<img src="{attrs[\'captcha-url\']}" bem:elem="captcha" qa:id="captcha-img"/>\n\t\t\t<b:button-link\n\t\t\t\t\tqa:id="refresh"\n\t\t\t\t\tremit:click="captcha:refresh"\n\t\t\t\t\ttext="{i18n(\'Не вижу код\')}"\n\t\t\t\t\tradar-id="refresh"\n\t\t\t/>\n\t\t</div>\n\t</fn:match>\n\t<fn:match name="footer">\n\t\t<form\n\t\t\taction=""\n\t\t\tbem:elem="footer"\n\t\t\tremit:submit.prevent="captcha:submit"\n\t\t>\n\t\t\t<div\n\t\t\t\tbem:elem="input"\n\t\t\t\tqa:id="input-error:{_this.getError()}"\n\t\t\t>\n\t\t\t\t<b:input\n\t\t\t\t\t\tqa:id="captcha-input"\n\t\t\t\t\t\tremit:input-input="captcha:input"\n\t\t\t\t\t\tautoblur\n\t\t\t\t\t\tautofocus\n\t\t\t\t\t\tid="input"\n\t\t\t\t\t\terror="{_this.getErrorText()}"\n\t\t\t\t\t\tplaceholder="{i18n(\'Введите код сюда\')}"\n\t\t\t\t\t\tmaxlength="255"\n\t\t\t\t\t\tname="captcha"\n\t\t\t\t\t\ttype="input"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2\n\t\t\t\t\t\tqa:id="submit"\n\t\t\t\t\t\ttext="{i18n(\'Готово\')}"\n\t\t\t\t\t\tprimary\n\t\t\t\t\t\tfluid\n\t\t\t\t\t\tcompact\n\t\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\t\tradar-id="submit"\n\t\t\t\t\t\tremit:click="captcha:submit"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</form>\n\t</fn:match>\n\n\t<b:layer\n\t\t\tremit:close="layer:close"\n\t\t\tmodel="{attrs.model}"\n\t\t\terror="{attrs.error}"\n\t\t\tmobile="{attrs.mobile}"\n\t\t\tname="confirm-clear-folder"\n\t\t\tclose\n\t\t\theader\n\t\t\tfooter\n\t\t\tcenter\n\t\t\tstandard\n\t\t\tresolvable\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{i18n(\'Введите код с картинки\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<fn:apply-match name="captcha" />\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<fn:apply-match name="footer" />\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-captcha/layer-captcha.html")});define("feast-tpl!ui-block/layer-captcha/layer-captcha.html",["feast-tpl!app/feast-tpl!ui-block/layer-captcha/layer-captcha.html"],function(a){return a});define("ui-block/layer-captcha/layer-captcha",["exports","cfg","feast","feast-tpl!./layer-captcha.html","ui-block/button-link/button-link","ui-block/button2/button2","ui-block/input/input","ui-block/layer/layer"],function(exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var h=o(a);var i=o(b);var j=o(c);var k=o(d);var l=o(e);var m=o(f);var n=o(g);function o(a){return a&&a.__esModule?a:{default:a}}var p=h.default.get("urls.captchaUrl");var q={emptyField:i18n("Пожалуйста, введите код с картинки"),wrongCode:i18n("Введён неверный код")};exports.default=i.default.Block.extend({name:"layer-captcha",template:j.default,blocks:{layer:n.default,button2:l.default,"button-link":k.default,input:m.default},events:{"captcha:refresh":"updateCaptcha","captcha:submit":"onSubmit","captcha:input":"onInput"},didMount:function a(){this.updateCaptcha()},updateCaptcha:function a(){this.set("captcha-url",p+"?r="+Math.random())},onSubmit:function a(){var b=this.ids.input.getValue();if(!b){this.set("empty-error",true);return}this.broadcast("layer:resolve",{close:true,resolveData:{capcha:b}})},onInput:function a(){this.set({"empty-error":false,"captcha-error":false})},getError:function a(){if(this.is("empty-error")){return"emptyField"}return this.is("captcha-error")?"wrongCode":""},getErrorText:function a(){return q[this.getError()]}})});define("feast-tpl!app/feast-tpl!ui-block/layer-addressbook/layer-addressbook.html",["feast"],function(a){return a.smartParse('<div ref="addressbookLayer" />\n',"app/feast-tpl!ui-block/layer-addressbook/layer-addressbook.html")});define("feast-tpl!ui-block/layer-addressbook/layer-addressbook.html",["feast-tpl!app/feast-tpl!ui-block/layer-addressbook/layer-addressbook.html"],function(a){return a});define("service/newAddressbook",["exports","./getModule"],function(exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var b=c(a);function c(a){return a&&a.__esModule?a:{default:a}}exports.default={load:b.default.bind(null,"addressbook/addressbook.bundle")}});var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("service/vkTeamsBridge",["require","exports","@mail/xray"],function(require,exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);function b(a){console.log("VKTeams Bridge: "+a)}function c(){var a,b;if(window.ThreadFeedJSBridge){return"AndroidWebView"}if(window.webkit&&window.webkit.messageHandlers){return"IOSWebView"}if(((a=window)===null||a===void 0?void 0:a.QWebChannel)&&((b=window.qt)===null||b===void 0?void 0:b.webChannelTransport)){return"DesktopQTWebView"}return null}var d=c();b(" platform="+d);var e=function(){function c(){}c.sendEvent=function(d,e){return __awaiter(this,void 0,Promise,function(){var f;return __generator(this,function(g){switch(g.label){case 0:b(" received event="+d);if(!!c.bridgeInstance)return[3,4];b("not have bridgeInstance. start creating");g.label=1;case 1:g.trys.push([1,3,,4]);return[4,c.createBridgeInstance().then(function(){b("bridge successfully created");c.bridgeInstance.postEvent("widgetReady")})];case 2:g.sent();return[3,4];case 3:f=g.sent();b("Cannot create bridge instance; error="+f);return[2];case 4:b("event="+d+", data="+JSON.stringify(e));a.default.send("wv_event_"+d);try{c.bridgeInstance.postEvent(d,e)}catch(c){b("postevent err="+c);a.default.send("wv_event_catch_"+d)}return[2]}})})};c.createBridgeInstance=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(b){return[2,new Promise(function(b,e){var f;if(!d){e("cannot define platform")}var g;switch(d){case"DesktopQTWebView":{new window.QWebChannel(window.qt.webChannelTransport,function(d){var e=d.objects.client;g=function(b,c){var d="wv_qt_"+b;a.default.send(d);e.postEvent({event:b,data:c})};c.bridgeInstance={postEvent:g};b()});break}case"IOSWebView":{var h=(f=window.webkit)===null||f===void 0?void 0:f.messageHandlers;g=function(b,c){var d;if(typeof((d=h===null||h===void 0?void 0:h[b])===null||d===void 0?void 0:d.postMessage)==="function"){var e="wv_ios_"+b;a.default.send(e);h[b].postMessage(c)}};break}case"AndroidWebView":{var i=window.ThreadFeedJSBridge;g=function(b,c){if(i&&i[b]){var d="wv_android_"+b;a.default.send(d);if(c&&typeof c==="object"&&!Array.isArray(c)){i[b].apply(i,Object.values(c))}else{i[b](c)}}};break}}if(g){c.bridgeInstance={postEvent:g};b();return}e()})]})})};return c}();exports.default=e});define("ui-block/layer-addressbook/layer-addressbook",["exports","data-source/index","default-values","feast","feast-tpl!./layer-addressbook.html","service/compose","service/lastseenStrings","service/newAddressbook","service/radars/decorator","service/vkTeamsBridge"],function(exports,a,b,c,d,e,f,g,h,i){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var j=r(a);var k=r(c);var l=r(d);var m=r(e);var n=r(f);var o=r(g);var p=r(h);var q=r(i);function r(a){return a&&a.__esModule?a:{default:a}}exports.default=k.default.Block.extend((0,p.default)()({name:"layer-addressbook",template:l.default,blocks:{},didMount:function a(){var c=this;o.default.load().then(function(a){if(c.app||!c.isMounted()){return}var d=c.onClose.bind(c);var e=c.get("composeMode");var f=c.get("contacts");var g=c.get("openEmail");var h=c.get("callsPromo");var i={LAST_SEEN_OMICRON:b.LAST_SEEN_OMICRON};var k={onClose:d,composeService:m.default,dataSource:j.default,view:{mode:e?"select":"default",options:{onlyWithMailbox:e}},openEmail:g,preSelectContacts:f,callsPromo:h,omicron:i,updateLastSeenStrings:n.default,vkTeamsBridge:q.default,touch:b.TOUCH_MODE};c.app=new a(c.refs.addressbookLayer);c.app.injectDependencies({state:k});c.app.render()})},onClose:function a(b){if(this.isMounted()){var c=this.get("router");if(c.request.alias==="contacts"){c.nav("/")}}this.destroyApp();if(b){this.broadcast("layer:resolve",{resolveData:b})}this.broadcast("layer:close")},destroyApp:function a(){if(this.app){this.app.unmount();this.app=null}}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-cloud-unavailable/layer-cloud-unavailable.html",["feast"],function(a){return a.smartParse('<div>\n\t<fn:match name="image">\n\t\t<div bem:elem="image"/>\n\t</fn:match>\n\n\t<b:layer name="cloud-unavailable"\n\t\t\tremit:close="layer:close"\n\t\t\tclose\n\t\t\tcenter\n\t\t\tmedia\n\t\t\tstandard>\n\n\t\t<fn:match name="content">\n\t\t\t<div bem:elem="row">\n\t\t\t\t<fn:apply-match name="image"/>\n\n\t\t\t\t<div bem:elem="text">\n\t\t\t\t\t<fn:value output="raw">\n\t\t\t\t\t\t_this.getText()\n\t\t\t\t\t</fn:value>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer">\n\t\t\t<b:button2\n\t\t\t\t\tqa:id="submit"\n\t\t\t\t\tremit:click="layer:resolve"\n\t\t\t\t\tevent:details="{close:true}"\n\t\t\t\t\ttext="{i18n(\'Вернуться\')}"\n\t\t\t\t\tprimary\n\t\t\t\t\tdisabled="{attrs.loading}"\n\t\t\t/>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-cloud-unavailable/layer-cloud-unavailable.html")});define("feast-tpl!ui-block/layer-cloud-unavailable/layer-cloud-unavailable.html",["feast-tpl!app/feast-tpl!ui-block/layer-cloud-unavailable/layer-cloud-unavailable.html"],function(a){return a});define("ui-block/layer-cloud-unavailable/layer-cloud-unavailable",["exports","feast","feast-tpl!./layer-cloud-unavailable.html","ui-block/button2/button2","ui-block/layer/layer"],function(exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var e=i(a);var f=i(b);var g=i(c);var h=i(d);function i(a){return a&&a.__esModule?a:{default:a}}exports.default=e.default.Block.extend({name:"layer-cloud-unavailable",template:f.default,blocks:{layer:h.default,button2:g.default},getText:function a(){return i18n("{boldstart}Облако Mail.ru{boldend} недоступно для вашей учетной записи.{br} Обратитесь к администратору вашего домена.",{"unsafe-boldstart":"<strong>","unsafe-boldend":"</strong>","unsafe-br":"<br/>"})}})});define("feast-tpl!app/feast-tpl!ui-block/layer-change-language/layer-change-language.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-change-language">\n\t<bem:mod name="touch" test="attrs.mobile"/>\n\t<bem:mod name="hidden" test="attrs.hidden"/>\n\n\t<b:layer remit:close="layer:close"\n\t\t\t error="{attrs.error}"\n\t\t\t processing="{attrs.processing}"\n\t\t\t mobile="{attrs.mobile}"\n\t\t\t name="change-language"\n\t\t\t close\n\t\t\t header\n\t\t\t footer\n\t\t\t center\n\t\t\t standard\n\t\t\t currentLang="{attrs.currentLang}"\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{i18n(\'Изменить язык\')}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<b:react-async\n\t\t\t\tcomponent="ChangeLanguage"\n\t\t\t\tdarkMode="{attrs[\'dark-mode\']}"\n\t\t\t\tpopupMode\n\t\t\t\tuse:mediator="themes-manager"\n\t\t\t\tcurrentLang="{attrs.currentLang}"\n\t\t\t\tonChangeLang="{_this.onChangeLang}"\n\t\t\t/>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2 remit:click="submit:click"\n\t\t\t\t\t\t   text="{i18n(\'Выбрать язык\')}"\n\t\t\t\t\t\t   primary\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   qa:id="submit"\n\t\t\t\t\t\t   radar-id="submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2 remit:click="cancel:click"\n\t\t\t\t\t\t   text="{i18n(\'Отменить\')}"\n\t\t\t\t\t\t   fluid\n\t\t\t\t\t\t   disabled="{attrs.processing}"\n\t\t\t\t\t\t   touch="{attrs.mobile}"\n\t\t\t\t\t\t   radar-id="cancel"\n\t\t\t\t\t\t   qa:id="cancel"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-change-language/layer-change-language.html")});define("feast-tpl!ui-block/layer-change-language/layer-change-language.html",["feast-tpl!app/feast-tpl!ui-block/layer-change-language/layer-change-language.html"],function(a){return a});define("ui-block/layer-change-language/layer-change-language",["exports","feast","feast-tpl!./layer-change-language.html","service/radars/decorator","service/radars/index","ui-block/button2/button2","ui-block/layer/layer","ui-block/react-async/react-async"],function(exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var h=o(a);var i=o(b);var j=o(c);var k=o(d);var l=o(e);var m=o(f);var n=o(g);function o(a){return a&&a.__esModule?a:{default:a}}exports.default=h.default.Block.extend((0,j.default)({})({name:"layer-change-language",template:i.default,blocks:{layer:m.default,button2:l.default,"react-async":n.default},events:{"submit:click":"onSubmit","cancel:click":"onCancel"},defaults:{},constructor:function a(){h.default.Block.apply(this,arguments);this.onChangeLang=this.onChangeLang.bind(this)},onChangeLang:function a(b){this.lang=b;(0,k.default)(["change_lang_button_click",b])},onSubmit:function a(){this.resolveLayer({resolveType:"ok",lang:this.lang})},onCancel:function a(){this.resolveLayer({resolveType:"close"})},resolveLayer:function a(b){this.broadcast("layer:resolve",{resolveData:b,close:true})}}))});define("feast-tpl!app/feast-tpl!ui-block/layer-disable-metathread/layer-disable-metathread.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-disable-metathread">\n\t<bem:mod name="touch" test="attrs.mobile" />\n\t<bem:mod name="full" test="!attrs.mobile" />\n\t<bem:mod name="hidden" test="attrs.hidden" />\n\n\t<fn:var name="title" value="{_this.getTitle()}" />\n\t<fn:var name="content" value="{_this.getContentText()}" />\n\n\t<b:layer\n\t\tremit:close="layer:close"\n\t\tmodel="{attrs.model}"\n\t\terror="{attrs.error}"\n\t\tmobile="{attrs.mobile}"\n\t\tname="layer-disable-metathread"\n\t\tclose\n\t\theader\n\t\tfooter\n\t\tcenter\n\t\tstandard\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t<fn:value>title</fn:value>\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t<span fn:if="content">\n\t\t\t\t<fn:value>content</fn:value>\n\t\t\t</span>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2\n\t\t\t\t\tqa:id="submit"\n\t\t\t\t\tremit:click="layer:resolve"\n\t\t\t\t\tevent:details="{close: true}"\n\t\t\t\t\ttext="{i18n(\'Отключить\')}"\n\t\t\t\t\tprimary\n\t\t\t\t\tcompact\n\t\t\t\t\tfluid\n\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t<b:button2\n\t\t\t\t\tqa:id="cancel"\n\t\t\t\t\tremit:click="layer:close"\n\t\t\t\t\ttext="{i18n(\'Отменить\')}"\n\t\t\t\t\tcompact\n\t\t\t\t\tfluid\n\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-disable-metathread/layer-disable-metathread.html")});define("feast-tpl!ui-block/layer-disable-metathread/layer-disable-metathread.html",["feast-tpl!app/feast-tpl!ui-block/layer-disable-metathread/layer-disable-metathread.html"],function(a){return a});define("ui-block/layer-disable-metathread/layer-disable-metathread",["exports","feast","feast-mod/brackets","feast-mod/folder-name","feast-tpl!./layer-disable-metathread.html","mail/Folder","models/metathread/metathread","ui-block/button2/button2","ui-block/layer/layer"],function(exports,a,b,c,d,e,f,g,h){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var i=o(a);var j=o(d);var k=o(e);var l=o(f);var m=o(g);var n=o(h);function o(a){return a&&a.__esModule?a:{default:a}}exports.default=i.default.Block.extend({name:"layer-disable-metathread",template:j.default,blocks:{layer:n.default,button2:m.default},_getName:function a(){var b=this.get("model");switch(true){case b instanceof k.default:return(0,c.getFolderName)(b);case b instanceof l.default:return(0,c.getMetathreadName)(b);default:return null}},_getType:function a(){var b=this.get("model");switch(true){case b instanceof k.default:return b.get("type");case b instanceof l.default:return b.get("metathread_data.category");default:return null}},getTitle:function a(){return i18n("Отключить {name}?",{name:(0,b.brackets)(this._getName())})},getContentText:function a(){switch(this._getType()){case"tomyself":return i18n("Перестанут работать фильтры, которые складывали письма в эту папку, а все письма перенесутся во «Входящие»");default:return null}}})});define("feast-tpl!app/feast-tpl!ui-block/layer-max-attach-count/layer-max-attach-count.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-max-attach-count">\n\t<b:react-async\n\t\tcomponent="FileLimitPopup"\n\t\tonClose="{_this.onClose}"\n\t\tonAttachClick="{_this.getReattachCallback()}"\n\t\tuse:mediator="themes-manager"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-max-attach-count/layer-max-attach-count.html")});define("feast-tpl!ui-block/layer-max-attach-count/layer-max-attach-count.html",["feast-tpl!app/feast-tpl!ui-block/layer-max-attach-count/layer-max-attach-count.html"],function(a){return a});define("ui-block/layer-max-attach-count/layer-max-attach-count",["exports","feast","feast-tpl!./layer-max-attach-count.html","ui-block/react-async/react-async"],function(exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var d=g(a);var e=g(b);var f=g(c);function g(a){return a&&a.__esModule?a:{default:a}}exports.default=d.default.Block.extend({name:"layer-max-attach-count",template:e.default,defaults:{onAttachClick:null},blocks:{"react-async":f.default},constructor:function a(){d.default.Block.apply(this,arguments);this.onClose=this.onClose.bind(this);this.getReattachCallback=this.getReattachCallback.bind(this)},onClose:function a(){this.broadcast("layer:close")},getReattachCallback:function a(){return this.get("onAttachClick")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-confirm-tomyself-enable/layer-confirm-tomyself-enable.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-confirm-tomyself-enable">\n\t<bem:mod name="touch" test="attrs.mobile" />\n\t<bem:mod name="full" test="!attrs.mobile" />\n\t<bem:mod name="hidden" test="attrs.hidden" />\n\n\t<fn:var name="title" value="{_this.getTitle()}" />\n\t<fn:var name="content" value="{_this.getContentText()}" />\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\n\t<b:layer\n\t\tremit:close="layer:close"\n\t\tmobile="{attrs.mobile}"\n\t\tname="layer-confirm-tomyself-enable"\n\t\tclose\n\t\theader\n\t\tfooter\n\t\tcenter\n\t\tstandard\n\t>\n\n\t\t<fn:match name="header" args="attrs">\n\t\t\t{messages.header}\n\t\t</fn:match>\n\n\t\t<fn:match name="content" args="attrs">\n\t\t\t{messages.content}\n\t\t</fn:match>\n\n\t\t<fn:match name="footer" args="attrs">\n\t\t\t<div bem:elem="submit-button">\n\t\t\t\t<b:button2\n\t\t\t\t\tqa:id="submit"\n\t\t\t\t\tremit:click="layer:resolve"\n\t\t\t\t\tevent:details="{close: true}"\n\t\t\t\t\ttext="{messages.submit}"\n\t\t\t\t\tprimary\n\t\t\t\t\tcompact\n\t\t\t\t\tfluid\n\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\tradar-id="layer-confirm-tomyself-enable-submit"\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t<fn:var name="cancel" value="{messages.cancel}"/>\n\n\t\t\t<fn:if test="cancel">\n\t\t\t\t<div bem:elem="cancel-button">\n\t\t\t\t\t<b:button2\n\t\t\t\t\t\tqa:id="cancel"\n\t\t\t\t\t\tremit:click="layer:close"\n\t\t\t\t\t\ttext="{cancel}"\n\t\t\t\t\t\tcompact\n\t\t\t\t\t\tfluid\n\t\t\t\t\t\ttouch="{attrs.mobile}"\n\t\t\t\t\t\tradar-id="layer-confirm-tomyself-enable-cancel"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</fn:if>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-confirm-tomyself-enable/layer-confirm-tomyself-enable.html")});define("feast-tpl!ui-block/layer-confirm-tomyself-enable/layer-confirm-tomyself-enable.html",["feast-tpl!app/feast-tpl!ui-block/layer-confirm-tomyself-enable/layer-confirm-tomyself-enable.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-confirm-tomyself-enable/layer-confirm-tomyself-enable",["require","exports","@mail/flags","feast","feast-tpl!./layer-confirm-tomyself-enable.html","ui-block/button2/button2","ui-block/layer/layer"],function(require,exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);exports.default=b.default.Block.extend({name:"layer-confirm-tomyself-enable",template:c.default,blocks:{layer:e.default,button2:d.default},getMessages:function(){var b=a.default.get("to-myself").isActive();if(b){return{header:i18n("Группировка «Письма себе» включена"),content:i18n('Проверьте папку во "Входящих", теперь все письма себе будут храниться в ней. Отключить группировку можно в настройках почты.'),submit:i18n("Понятно")}}return{header:i18n("Включить группировку «Письма себе»?"),content:i18n("Почта добавит подпапку «Письма себе» во «Входящих» и перенесет туда письма, которые вы отправляли на свой адрес."),submit:i18n("Включить"),cancel:i18n("Отменить")}}})});define("feast-tpl!app/feast-tpl!ui-block/layer-share-folder/layer-share-folder.html",["feast"],function(a){return a.smartParse("<div/>\n","app/feast-tpl!ui-block/layer-share-folder/layer-share-folder.html")});define("feast-tpl!ui-block/layer-share-folder/layer-share-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-share-folder/layer-share-folder.html"],function(a){return a});define("service/settings",["exports","service/getModule"],function(exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var b=c(a);function c(a){return a&&a.__esModule?a:{default:a}}exports.default={loadShareFolder:b.default.bind(null,"share-folder")}});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-share-folder/layer-share-folder",["require","exports","cfg","feast","feast-tpl!./layer-share-folder.html","features","service/auth","service/settings"],function(require,exports,a,b,c,d,e,f){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);exports.default=b.default.Block.extend({name:"layer-share-folder",template:c.default,defaults:{model:null,allFolders:[]},ui:null,didMount:function(){var b=this;var c=this.get("model");var g=this.get("allFolders");f.default.loadShareFolder().then(function(f){b.ui=new f(b.el);b.ui.injectDependencies({context:{appType:"share",allFolders:g,onClose:b.onClose.bind(b),folder:c,features:d.default,user:e.default.user,avatarBaseUrl:a.default.get("urls.avatarUrl"),bizBaseUrl:a.default.get("urls.bizBaseUrl"),from:"folders-lr-ctx"}});b.ui.render()})},onClose:function(){var a=this.get("onLayerClose");if(a){a()}this.ui.destroy();this.broadcast("layer:close")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-share-opportunities/layer-share-opportunities.html",["feast"],function(a){return a.smartParse("<div/>\n","app/feast-tpl!ui-block/layer-share-opportunities/layer-share-opportunities.html")});define("feast-tpl!ui-block/layer-share-opportunities/layer-share-opportunities.html",["feast-tpl!app/feast-tpl!ui-block/layer-share-opportunities/layer-share-opportunities.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-share-opportunities/layer-share-opportunities",["require","exports","cfg","feast","feast-tpl!./layer-share-opportunities.html","features","service/auth","service/settings"],function(require,exports,a,b,c,d,e,f){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);f=__importDefault(f);exports.default=b.default.Block.extend({name:"layer-share-opportunities",template:c.default,ui:null,didMount:function(){var b=this;f.default.loadShareFolder().then(function(c){b.ui=new c(b.el);b.ui.injectDependencies({context:{appType:"share_opportunities",onClose:b.onClose.bind(b),features:d.default,user:e.default.user,avatarBaseUrl:a.default.get("urls.avatarUrl"),bizBaseUrl:a.default.get("urls.bizBaseUrl"),from:"folders-lr-ctx"}});b.ui.render()})},onClose:function(){var a=this.get("onLayerClose");if(a){a()}this.ui.destroy();this.broadcast("layer:close")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-share-folder-action/layer-share-folder-action.html",["feast"],function(a){return a.smartParse("<div/>\n","app/feast-tpl!ui-block/layer-share-folder-action/layer-share-folder-action.html")});define("feast-tpl!ui-block/layer-share-folder-action/layer-share-folder-action.html",["feast-tpl!app/feast-tpl!ui-block/layer-share-folder-action/layer-share-folder-action.html"],function(a){return a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __rest=this&&this.__rest||function(a,b){var c={};for(var d in a)if(Object.prototype.hasOwnProperty.call(a,d)&&b.indexOf(d)<0)c[d]=a[d];if(a!=null&&typeof Object.getOwnPropertySymbols==="function")for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++){if(b.indexOf(d[e])<0&&Object.prototype.propertyIsEnumerable.call(a,d[e]))c[d[e]]=a[d[e]]}return c};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-share-folder-action/layer-share-folder-action",["require","exports","feast","feast-tpl!./layer-share-folder-action.html","service/settings"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);exports.default=a.default.Block.extend({name:"layer-share-folder-action",template:b.default,ui:null,didMount:function(){var a=this;var b=this.attrs,d=b.mode,e=__rest(b,["mode"]);c.default.loadShareFolder().then(function(b){a.ui=new b(a.el);a.ui.injectDependencies({context:__assign(__assign({},e),{appType:d,onClose:a.onClose.bind(a),from:"octavius-letter"})});a.ui.render()})},onClose:function(){var a=this.get("onLayerClose");if(a){a()}this.ui.destroy();this.broadcast("layer:close")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-deny-shared-folder/layer-deny-shared-folder.html",["feast"],function(a){return a.smartParse("<div/>\n","app/feast-tpl!ui-block/layer-deny-shared-folder/layer-deny-shared-folder.html")});define("feast-tpl!ui-block/layer-deny-shared-folder/layer-deny-shared-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-deny-shared-folder/layer-deny-shared-folder.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-deny-shared-folder/layer-deny-shared-folder",["require","exports","cfg","feast","feast-tpl!./layer-deny-shared-folder.html","service/auth","service/settings"],function(require,exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);e=__importDefault(e);exports.default=b.default.Block.extend({name:"layer-deny-shared-folder",template:c.default,defaults:{model:null},ui:null,didMount:function(){var b=this;var c=this.get("model");e.default.loadShareFolder().then(function(e){b.ui=new e(b.el);b.ui.injectDependencies({context:{appType:"deny",onClose:b.onClose.bind(b),folder:c,user:d.default.user,avatarBaseUrl:a.default.get("urls.avatarUrl"),bizBaseUrl:a.default.get("urls.bizBaseUrl"),from:"folders-lr-ctx"}});b.ui.render()})},onClose:function(){var a=this.get("onLayerClose");if(a){a()}this.ui.destroy();this.broadcast("layer:close")}})});define("feast-tpl!app/feast-tpl!ui-block/layer-unsafe-attach/layer-unsafe-attach.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-unsafe-attach">\n\t<fn:var name="messages" value="{_this.getMessages()}"/>\n\n\t<bem:mod name="full" test="!attrs.mobile"/>\n\n\t<b:layer name="unsafe-attach"\n\t\t\t remit:close="layer:close"\n\t\t\t error="{attrs.error}"\n\t\t\t mobile="{attrs.mobile}"\n\t\t\t close\n\t\t\t center\n\t\t\t header\n\t\t\t footer\n\t\t\t standard>\n\n\t\t<fn:match name="header">\n\t\t\t<div bem:block="layer-unsafe-attach__image"/>\n\t\t\t<div bem:elem="text">\n\t\t\t\t<fn:value output="raw">messages.header</fn:value>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t\t<fn:match name="content">\n\t\t\t<div bem:elem="text">\n\t\t\t\t<fn:value output="raw">messages.content</fn:value>\n\t\t\t</div>\n\t\t</fn:match>\n\n\t\t<fn:match name="footer">\n\t\t\t<b:checkbox\n\t\t\t\tlabel="{i18n(\'Я хочу скачать этот файл\')}"\n\t\t\t\tremit:toggle-checkbox="toggle:checkbox"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tbem:elem="submit-button"\n\t\t\t\tfn:if="attrs.confirmed"\n\t\t\t>\n\t\t\t\t<b:button2\n\t\t\t\t\tqa:id="submit"\n\t\t\t\t\tremit:click="submit:click"\n\t\t\t\t\ttext="{i18n(\'Скачать файл\')}"\n\t\t\t\t\tprimary\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</fn:match>\n\t</b:layer>\n</div>\n',"app/feast-tpl!ui-block/layer-unsafe-attach/layer-unsafe-attach.html")});define("feast-tpl!ui-block/layer-unsafe-attach/layer-unsafe-attach.html",["feast-tpl!app/feast-tpl!ui-block/layer-unsafe-attach/layer-unsafe-attach.html"],function(a){return a});define("ui-block/layer-unsafe-attach/layer-unsafe-attach",["exports","feast","feast-tpl!./layer-unsafe-attach.html","ui-block/button2/button2","ui-block/checkbox/checkbox","ui-block/layer/layer"],function(exports,a,b,c,d,e){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var f=k(a);var g=k(b);var h=k(c);var i=k(d);var j=k(e);function k(a){return a&&a.__esModule?a:{default:a}}exports.default=f.default.Block.extend({name:"layer-unsafe-attach",template:g.default,blocks:{layer:j.default,button2:h.default,checkbox:i.default},defaults:{confirmed:false},events:{"toggle:checkbox":"onToggleCheckbox","submit:click":"onSubmit"},onToggleCheckbox:function a(){this.invert("confirmed")},onSubmit:function a(){this.resolveLayer({resolveType:"ok"})},resolveLayer:function a(b){this.broadcast("layer:resolve",{resolveData:b,close:true})},getMessages:function a(){var b=this.attrs.filename;if(b.length>25){b=b.slice(0,10)+"..."+b.slice(-10)}return{header:i18n("Вы собираетесь скачать {filename}.{extension}",{filename:b,extension:this.attrs.extension}),content:i18n("Файл был проверен с{nbsp}помощью антивируса Kaspersky Lab, но остается вероятность, что файл может причинить вред. Скачивайте его, только если вы знаете, {strongOpen}что это за{nbsp}файл{strongClose} и {strongOpen}кто вам его прислал{strongClose}.",{"unsafe-strongOpen":"<strong>","unsafe-strongClose":"</strong>","unsafe-nbsp":"&nbsp;"})}}})});define("feast-tpl!app/feast-tpl!ui-block/layer-oversize-attach-cancel/layer-oversize-attach-cancel.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-oversize-attach-cancel">\n\t<b:react-async\n\t\tcomponent="OversizeAttachCancelPopup"\n\t\tonClose="{_this.onClose}"\n\t\tonSubmit="{_this.onSubmit}"\n\t\tfrom="{attrs.from}"\n\t\tuse:mediator="themes-manager"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-oversize-attach-cancel/layer-oversize-attach-cancel.html")});define("feast-tpl!ui-block/layer-oversize-attach-cancel/layer-oversize-attach-cancel.html",["feast-tpl!app/feast-tpl!ui-block/layer-oversize-attach-cancel/layer-oversize-attach-cancel.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-oversize-attach-cancel/layer-oversize-attach-cancel",["require","exports","feast","feast-tpl!./layer-oversize-attach-cancel.html","ui-block/react-async/react-async"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);exports.default=a.default.Block.extend({name:"layer-oversize-attach-cancel",template:b.default,blocks:{"react-async":c.default},constructor:function(){a.default.Block.apply(this,arguments);this.onClose=this.onClose.bind(this);this.onSubmit=this.onSubmit.bind(this)},onClose:function(){this.broadcast("layer:close")},onSubmit:function(){this.broadcast("layer:resolve",{close:true})}})});define("feast-tpl!app/feast-tpl!ui-block/layer-choose-save-folder/layer-choose-save-folder.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-choose-save-folder">\n\t<b:react-async\n\t\tcomponent="LayerChooseSaveFolder"\n\t\tuse:mediator="themes-manager"\n\t\ttree="{attrs.tree}"\n\t\tonSave="{_this.onSave}"\n\t\tonClose="{_this.onClose}"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-choose-save-folder/layer-choose-save-folder.html")});define("feast-tpl!ui-block/layer-choose-save-folder/layer-choose-save-folder.html",["feast-tpl!app/feast-tpl!ui-block/layer-choose-save-folder/layer-choose-save-folder.html"],function(a){return a});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/dnd-notifies",["require","exports","default-values","helpers/copyToClipboard","service/notify"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.showUnknownErrNotify=exports.getNotifyParams=void 0;c=__importDefault(c);var d=function(a){var b={count:a};return i18n.plural(a,[i18n("{count} файлов",b),i18n("{count} файл",b),i18n("{count} файла",b)])};var e=function(a){var b={count:a};return i18n.plural(a,[i18n("загружается",b),i18n("загружается",b),i18n("загружаются",b)])};var f=function(a){var b={count:a};return i18n.plural(a,[i18n("загружено",b),i18n("загружен",b),i18n("загружено",b)])};function g(g,h,i,j){if(i===void 0){i=""}var k=g.successes,l=g.total,m=g.firstFileName;var n=[{text:j?i18n("в {folderName}",{folderName:j}):i18n("в Облако"),link:""+a.CLOUD_HOME_URL+i}];var o=l!==k?i18n(" из")+" "+l:"";var p=h?d(l)+" "+e(l):""+d(k)+o+" "+f(k);var q={text:p,qa:h?"dnd-cloud-loading":"dnd-cloud-success:"+k+":"+l};if(l===1&&m){var r=h?i18n("загружается"):i18n("загружен");var s="...";var t=r.length+s.length+1;var u=c.default.MAX_LENGTH-t;var v=m.length<u?m:""+m.slice(0,u)+s;q={text:v+" "+r,icon:"ACTIONS_CLOUD_UPLOAD",qa:h?"dnd-cloud-loading":"dnd-cloud-success-one"}}q.secondaryActions=[];q.link=i;if(!h){if(a.DND_CLOUD_SHARE&&b.isCopySupported()){q.secondaryActions.push({text:i18n("Скопировать ссылку"),event:"copy"})}if(a.DND_CLOUD_FOLDER_CHOICE){q.secondaryActions.push({text:i18n("Выбрать папку"),event:"choice"})}if(!k){q={text:i18n("Не удалось загрузить файлы"),type:c.default.types.error,qa:"dnd-cloud-all-failed"}}}return __assign({actions:n,duration:h?void 0:a.DND_NOTIFY_DURATION},q)}exports.getNotifyParams=g;function h(){return c.default.add({type:c.default.types.error,text:i18n("Что-то пошло не так"),qa:"dnd-cloud-err"})}exports.showUnknownErrNotify=h});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/check-files-from-event",["require","exports","cfg","lazy.modules","service/notify","service/radars/index"],function(require,exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CheckFilesError=void 0;a=__importDefault(a);c=__importDefault(c);d=__importDefault(d);var e;(function(a){a["NO_FILES"]="no files";a["MAX_FILES"]="more than max";a["OVERSIZE_FILES"]="oversize files"})(e=exports.CheckFilesError||(exports.CheckFilesError={}));function f(f){var g=f.event,h=f.limit,i=f.isCloudLoad,j=i===void 0?false:i;var k=g.dataTransfer;var l={files:(k===null||k===void 0?void 0:k.files)||[],items:(k===null||k===void 0?void 0:k.items)||[],types:(k===null||k===void 0?void 0:k.types)||[]};var m={type:g.type,target:g.target,dataTransfer:l};return b.lazyFileAPI().then(function(b){var f;var g=!!a.default.get("qa");var i=g?window.DragAndDropTestFiles:b.getFiles(m);var k;if(!i||!i.length||i.length===0){var l=j?i18n("Не удалось загрузить файлы"):i18n("Не удалось прикрепить файл");c.default.add({type:c.default.types.error,text:l});k=e.NO_FILES}if(i.length>h){k=e.MAX_FILES}var n=g?window.DragAndDropTestFiles:(f=m.dataTransfer)===null||f===void 0?void 0:f.files;var o=(n===null||n===void 0?void 0:n.length)||0;var p=o-((i===null||i===void 0?void 0:i.length)||0);d.default({type:"dnd_files-check",dwh:{total:o,filtered:p}});return{files:i,error:k}}).catch(function(a){return{files:[],error:a}})}exports.default=f});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/get-attachments-from-files",["require","exports","mail/Attachment"],function(require,exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getAttachmentsFromFiles=void 0;a=__importDefault(a);var b=function(b){var c=b.map(function(b){return a.default.from(b)});return Promise.all(c)};exports.getAttachmentsFromFiles=b});define("helpers/check-oversize-files",["require","exports","helpers/get-attachments-from-files"],function(require,exports,a){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.checkOversizeFiles=void 0;var b=function(b){return a.getAttachmentsFromFiles(b).then(function(a){var b=a.find(function(a){return a.isOverMaxLinkSize()&&a.isBlob()});return!!b})};exports.checkOversizeFiles=b});var __assign=this&&this.__assign||function(){__assign=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++){b=arguments[c];for(var e in b)if(Object.prototype.hasOwnProperty.call(b,e))a[e]=b[e]}return a};return __assign.apply(this,arguments)};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/on-oversize-attach-add",["require","exports","default-values","helpers/querystring-add","service/layer","service/radars/index"],function(require,exports,a,b,c,d){"use strict";Object.defineProperty(exports,"__esModule",{value:true});b=__importDefault(b);c=__importDefault(c);d=__importDefault(d);var e;(function(a){a["LoadSubmit"]="LOAD_SUBMIT";a["CancelPayment"]="CANCEL_PAYMENT"})(e||(e={}));var f=function(a){var b=a.details,c=b.message.type,d=b.layer;if(c===e.LoadSubmit){d.broadcast("layer:resolve");d.broadcast("layer:hide")}if(c===e.CancelPayment){d.broadcast("layer:close")}};var g=function(e,g){var h=e.reduce(function(a,b){var c=a.total,d=a.max;var e=b.get("size");return{max:Math.max(e,d),total:c+e}},{total:0,max:0}),i=h.total,j=h.max;var k=e.length;d.default({type:"compose_oversize-cloud_init",dwh:{totalFileSize:i,maxFileSize:j,filesCount:k}});var l={"close-on-dimmer":false,"close-on-esc":false,"hide-headline":true};var m=function(e,g){var h=b.default(a.CLOUD_TARIFFS_IFRAME_URL,__assign({max_size:j,total_size:i,from:e},g&&{afterReload:g}));return c.default.openIframeLayer({paramsKey:"cloud_tariff",additionalParams:{url:h,close:true},factoryParams:l,onPostMessage:f}).then(function(a){return new Promise(function(b,c){a.on("layer:resolve",function(){d.default("compose_oversize-cloud_submit");b()});a.on("layer:close",c)})}).catch(function(){return c.default.open("oversize-attach-cancel",{from:e},__assign(__assign({},l),{resolvable:true,"reject-on-close":true})).then(function(){return m(e,true)}).catch(function(){d.default("compose_oversize-cloud_close");return Promise.reject("oversize-attach_close-cloud-tariffs")})})};return m(g)};exports.default=g});var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/load-oversize-file-to-cloud",["require","exports","default-values","helpers/dnd-notifies","helpers/get-attachments-from-files","helpers/load-file-to-cloud","helpers/on-oversize-attach-add","service/cloud","service/radars/index"],function(require,exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);var h="octavius_dnd_over";var i=function(c){return __awaiter(void 0,void 0,void 0,function(){var d,e;return __generator(this,function(i){switch(i.label){case 0:i.trys.push([0,2,,3]);return[4,f.default.createFiles(c,a.OVERSIZE_CLOUD_ATTACHES_FOLDER)];case 1:d=i.sent();g.default("dnd_cld_over_ok");return[2,d];case 2:e=i.sent();g.default({type:"dnd_cld_load_over_err",rlog:h,rlog_message:e});b.showUnknownErrNotify();return[3,3];case 3:return[2]}})})};var j=function(a){return __awaiter(void 0,void 0,void 0,function(){var j,k,l,m,n,o,p,q;return __generator(this,function(r){switch(r.label){case 0:g.default("dnd_cld_over_files");j=null;r.label=1;case 1:r.trys.push([1,6,,7]);return[4,c.getAttachmentsFromFiles(a)];case 2:k=r.sent();return[4,e.default(k,"dnd")];case 3:r.sent();l=b.getNotifyParams({total:a.length,firstFileName:a[0].name},true);j=d.showLoadNotify(l);return[4,f.default.isAgreedLA()];case 4:r.sent();return[4,i(a)];case 5:m=r.sent();n=d.prepareNotifyParams(m),o=n.notifyParams,p=n.fulfilledFilesObjects;d.showLoadNotify(o,p);return[3,7];case 6:q=r.sent();g.default({type:"dnd_cld_over_err",rlog:h,rlog_message:q});return[3,7];case 7:j===null||j===void 0?void 0:j.close();return[2]}})})};exports.default=j});var __createBinding=this&&this.__createBinding||(Object.create?function(a,b,c,d){if(d===undefined)d=c;Object.defineProperty(a,d,{enumerable:true,get:function(){return b[c]}})}:function(a,b,c,d){if(d===undefined)d=c;a[d]=b[c]});var __setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(a,b){Object.defineProperty(a,"default",{enumerable:true,value:b})}:function(a,b){a["default"]=b});var __importStar=this&&this.__importStar||function(a){if(a&&a.__esModule)return a;var b={};if(a!=null)for(var c in a)if(c!=="default"&&Object.prototype.hasOwnProperty.call(a,c))__createBinding(b,a,c);__setModuleDefault(b,a);return b};var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("helpers/load-file-to-cloud",["require","exports","@mail/flags","default-values","helpers/check-files-from-event","helpers/check-oversize-files","helpers/copyToClipboard","helpers/dnd-notifies","helpers/load-oversize-file-to-cloud","service/cloud","service/layer","service/notify","service/radars/index"],function(require,exports,a,b,c,d,e,f,g,h,i,j,k){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.prepareNotifyParams=exports.showLoadNotify=void 0;a=__importDefault(a);c=__importStar(c);e=__importDefault(e);g=__importDefault(g);h=__importStar(h);i=__importDefault(i);j=__importDefault(j);k=__importDefault(k);var l;(function(a){a["choice"]="choice";a["copy"]="copy"})(l||(l={}));var m="octavius_dnd";var n=function(a){i.default.open("cloud-license",{},{dimmer:true,resolvable:true,"reject-on-close":true}).then(function(){k.default("dnd_cld_accept_la");h.default.agreeLa().then(function(){h.default.isAgreedLA().then(function(b){if(b){t(a);return}k.default("dnd_cld_no_accept");f.showUnknownErrNotify()})}).catch(function(a){k.default({type:"dnd_agr_la_err",rlog:"dnd_agr_la_err",rlog_message:a});f.showUnknownErrNotify()})}).catch(function(){k.default("dnd_cld_discard_la")})};function o(a){c.default({event:a,limit:b.DND_CLOUD_FILES_LIMIT,isCloudLoad:true}).then(function(a){var d=a.files,e=a.error;switch(e){case c.CheckFilesError.MAX_FILES:j.default.add({text:i18n("Превышено разрешенное кол-во файлов для загрузки"),qa:"dnd-cloud-max-files"});k.default("dnd_cld_max_files");d=d.slice(0,b.DND_CLOUD_FILES_LIMIT);break;case c.CheckFilesError.NO_FILES:k.default("dnd_cld_no_files");return;default:if(e){k.default({type:"dnd_cld_some_err",rlog:m,rlog_message:e});return}}return d}).then(function(a){return d.checkOversizeFiles(a).then(function(c){if(c){if(b.OVERSIZE_CLOUD_ATTACHES){return g.default(a)}j.default.error({text:i18n("Вы не можете загрузить файлы более 2Гб"),qa:"dnd-cloud-over-files"});k.default("dnd_cld_over_files");return}h.default.isAgreedLA().then(function(b){if(b){t(a);return}n(a)}).catch(function(b){var c=b.type,d=b.err;if(c===h.Errors.ResponseNoAuth){n(a);return}f.showUnknownErrNotify();k.default({type:"dnd_cld_"+c,rlog:m,rlog_message:d})});k.default("dnd_cld_load_success")})})}exports.default=o;var p=function(a,c){h.default.createWebLink(c).then(function(a){return e.default(a)}).then(function(){var c=[{text:i18n("Скопировано"),event:null}];if(b.DND_CLOUD_FOLDER_CHOICE){c.push({text:i18n("Выбрать папку"),event:"choice"})}a.set({"secondary-actions":c});k.default("dnd_cld_share")}).catch(function(){a.close();j.default.error({text:i18n("Не удалось скопировать ссылку")});k.default("dnd_cld_err-share")})};var q=function(a,b){return __awaiter(void 0,void 0,void 0,function(){var c,d,e;return __generator(this,function(g){switch(g.label){case 0:g.trys.push([0,3,,4]);return[4,h.default.getFoldersTree()];case 1:c=g.sent();d=c.map(function(a){var b=a.name;return b});a===null||a===void 0?void 0:a.close();return[4,i.default.open("choose-save-folder",{tree:d,filesObjects:b},{dimmer:true,resolvable:true,"reject-on-close":true})];case 2:g.sent();k.default("cl_ch_fold_resolve");return[3,4];case 3:e=g.sent();k.default({type:"cl_ch_fold_err",rlog:"cl_ch_fold_err",rlog_message:e});f.showUnknownErrNotify();return[3,4];case 4:return[2]}})})};var r=function(a,b){var c=j.default.add(a);c.on("action:secondary",function(d){var e=d.details;switch(e){case l.copy:return p(c,a.link);case l.choice:return q(c,b)}});return c};exports.showLoadNotify=r;var s=function(a){var b,c;var d=a.length;var e=a.filter(function(a){var b=a.status;return b===h.PromiseStatus.fulfilled});var g=e.length;var i=d-g;var j=((b=e[0])===null||b===void 0?void 0:b.value)||{},k=j.name,l=j.path,m=l===void 0?"":l;var n=(c=m.match(/.*\//))===null||c===void 0?void 0:c[0];var o=d===1?m:n;var p=f.getNotifyParams({successes:g,total:d,firstFileName:k},false,o);var q=e.map(function(a){var b=a.value,c=b.path,d=b.name;return{path:c,name:d}});return{notifyParams:p,fulfilledFilesObjects:q,total:d,successCount:g,fails:i}};exports.prepareNotifyParams=s;function t(b){var c=b.length;var d=f.getNotifyParams({total:c,firstFileName:b[0].name},true);var e=exports.showLoadNotify(d);h.default.createFiles(b).then(function(b){var c=exports.prepareNotifyParams(b),d=c.notifyParams,f=c.fulfilledFilesObjects,g=c.total,i=c.successCount,j=c.fails;e===null||e===void 0?void 0:e.close();exports.showLoadNotify(d,f);k.default({type:"dnd_to_cloud_success",dwh:{total:g,successes:i,fails:j}});var l=a.default.get("octavius-notify-dnd-v2");if(l.getCount("show")>0){k.default("dnd_to_cloud_after_promo_"+l.index)}if(!i){k.default("dnd_to_cloud_all_fail")}if(j){b.filter(function(a){var b=a.status;return b===h.PromiseStatus.rejected}).forEach(function(a){var b=a.reason;return k.default({type:"dnd_to_cloud_fail",rlog:m,rlog_message:b})})}}).catch(function(a){e===null||e===void 0?void 0:e.close();f.showUnknownErrNotify();k.default({type:"dnd_cld__create_err",rlog:m,rlog_message:a})})}});var __awaiter=this&&this.__awaiter||function(a,b,c,d){function e(a){return a instanceof c?a:new c(function(b){b(a)})}return new(c||(c=Promise))(function(c,f){function g(a){try{i(d.next(a))}catch(a){f(a)}}function h(a){try{i(d["throw"](a))}catch(a){f(a)}}function i(a){a.done?c(a.value):e(a.value).then(g,h)}i((d=d.apply(a,b||[])).next())})};var __generator=this&&this.__generator||function(a,b){var c={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},d,e,f,g;return g={next:h(0),throw:h(1),return:h(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function h(a){return function(b){return i([a,b])}}function i(g){if(d)throw new TypeError("Generator is already executing.");while(c)try{if(d=1,e&&(f=g[0]&2?e["return"]:g[0]?e["throw"]||((f=e["return"])&&f.call(e),0):e.next)&&!(f=f.call(e,g[1])).done)return f;if(e=0,f)g=[g[0]&2,f.value];switch(g[0]){case 0:case 1:f=g;break;case 4:c.label++;return{value:g[1],done:false};case 5:c.label++;e=g[1];g=[0];continue;case 7:g=c.ops.pop();c.trys.pop();continue;default:if(!(f=c.trys,f=f.length>0&&f[f.length-1])&&(g[0]===6||g[0]===2)){c=0;continue}if(g[0]===3&&(!f||g[1]>f[0]&&g[1]<f[3])){c.label=g[1];break}if(g[0]===6&&c.label<f[1]){c.label=f[1];f=g;break}if(f&&c.label<f[2]){c.label=f[2];c.ops.push(g);break}if(f[2])c.ops.pop();c.trys.pop();continue}g=b.call(a,c)}catch(a){g=[6,a];e=0}finally{d=f=0}if(g[0]&5)throw g[1];return{value:g[0]?g[1]:void 0,done:true}}};var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-choose-save-folder/layer-choose-save-folder",["require","exports","feast","feast-tpl!./layer-choose-save-folder.html","helpers/dnd-notifies","helpers/load-file-to-cloud","service/cloud","service/radars/index","ui-block/react-async/react-async"],function(require,exports,a,b,c,d,e,f,g){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);e=__importDefault(e);f=__importDefault(f);g=__importDefault(g);exports.default=a.default.Block.extend({name:"layer-choose-save-folder",template:b.default,defaults:{tree:[],filesObjects:[]},blocks:{"react-async":g.default},constructor:function(){a.default.Block.apply(this,arguments);this.onSave=this.onSave.bind(this);this.onClose=this.onClose.bind(this)},changeFilesObjects:function(a){var b=this.get("filesObjects");var c=b.map(function(b){var c=b.name,d=b.path;var e=d.split("/");e[1]=a;return{name:c,path:e.join("/")}});this.set("filesObjects",c);return c},moveFileOrFolder:function(a,b){if(!a.startsWith("/")){return Promise.reject("cld_reg_err")}var c=a.slice(1,a.length).split("/");c[0]=b;var d="/"+c.join("/");return e.default.move(a,d)},showLoadingNotify:function(a){var b=this.get("filesObjects");var e=c.getNotifyParams({total:b.length,firstFileName:b[0].name},true,a,a);return d.showLoadNotify(e)},getPrevFolder:function(){var a=this.get("filesObjects");var b=a[0].path;if(a.length===1){return b}return b.slice(0,b.lastIndexOf("/")+1)},onSave:function(a){var b;return __awaiter(this,void 0,void 0,function(){var e,g,h,i,j,k,l,m,n,o,p,q,r;return __generator(this,function(s){switch(s.label){case 0:e=this.get("filesObjects");g=e.length;h=g===1;i=this.showLoadingNotify(a);s.label=1;case 1:s.trys.push([1,3,,4]);j=this.getPrevFolder();return[4,this.moveFileOrFolder(j,a)];case 2:s.sent();e=this.changeFilesObjects(a);k=e[0]||{},l=k.name,m=k.path,n=m===void 0?"":m;o=(b=n.match(/.*\//))===null||b===void 0?void 0:b[0];p=encodeURIComponent(h?n:o);q=c.getNotifyParams({successes:g,total:g,firstFileName:l},false,p,a);i===null||i===void 0?void 0:i.close();d.showLoadNotify(q,e);this.broadcast("layer:resolve",{close:true});return[3,4];case 3:r=s.sent();i===null||i===void 0?void 0:i.close();c.showUnknownErrNotify();f.default({type:"cld_move_err",rlog:"cld_move_err",rlog_message:r});return[3,4];case 4:return[2]}})})},onClose:function(){this.broadcast("layer:resolve",{close:true})}})});define("feast-tpl!app/feast-tpl!ui-block/layer-compose-template-select/layer-compose-template-select.html",["feast"],function(a){return a.smartParse('<div qa:id="layer-compose-template-select">\n\t<b:react-async\n\t\tcomponent="LayerTemplateSelect"\n\t\tuse:mediator="themes-manager"\n\t\tonChoose="{attrs.onChoose}"\n\t\tfetchTemplates="{attrs.fetchTemplates}"\n\t\tappliedTemplate="{attrs.appliedTemplate}"\n\t\tonClose="{_this.onClose}"\n\t/>\n</div>\n',"app/feast-tpl!ui-block/layer-compose-template-select/layer-compose-template-select.html")});define("feast-tpl!ui-block/layer-compose-template-select/layer-compose-template-select.html",["feast-tpl!app/feast-tpl!ui-block/layer-compose-template-select/layer-compose-template-select.html"],function(a){return a});var __importDefault=this&&this.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};define("ui-block/layer-compose-template-select/layer-compose-template-select",["require","exports","feast","feast-tpl!./layer-compose-template-select.html","ui-block/react-async/react-async"],function(require,exports,a,b,c){"use strict";Object.defineProperty(exports,"__esModule",{value:true});a=__importDefault(a);b=__importDefault(b);c=__importDefault(c);exports.default=a.default.Block.extend({name:"layer-compose-template-select",template:b.default,blocks:{"react-async":c.default},constructor:function(){a.default.Block.apply(this,arguments);this.onClose=this.onClose.bind(this)},onClose:function(){this.broadcast("layer:close")}})});